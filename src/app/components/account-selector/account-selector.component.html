<div class="account-selector-container">
  <div class="from-account" (click)="openAccountList()" *ngIf="accounts">
    <ng-container *ngIf="account">
      <div class="name">
        {{ account.name }}
        <small>
          <wallet-address [value]="account.address"></wallet-address>
        </small>
      </div>
      <div class="balance">{{ account.balance / 1e8 | number: '0.0-8' }} ZBC</div>
    </ng-container>

    <ng-container *ngIf="!account">
      No Account Selected
    </ng-container>
  </div>

  <div class="from-account" *ngIf="isLoading">
    <div style="vertical-align: middle">
      <i class="fas fa-circle-notch fa-spin" style="font-size: 16px"></i>&nbsp;
      <span>{{ 'Getting your accounts...' | translate }}</span>
    </div>
  </div>

  <div class="from-account" *ngIf="isError">
    <div class="text-center" style="width: 100%;">
      <i matPrefix class="fa fa-exclamation-triangle"></i>
      <div style="margin-bottom: 8px;">
        {{ 'An error occurred while processing your request' | translate }}
      </div>
      <button mat-flat-button class="small" color="primary" (click)="getAccounts()">
        {{ 'Try Again' | translate }}
      </button>
    </div>
  </div>
</div>

<ng-template #accountDialog>
  <div style="max-height: 400px">
    <h3 class="mat-h3" id="modal-basic-title">
      <b>{{ 'Your Accounts' | translate }}</b>
    </h3>

    <div class="account-list" *ngIf="accounts">
      <mat-card *ngFor="let acc of accounts" class="account-card" (click)="onSwitchAccount(acc)">
        <div class="row" [ngClass]="account.path == acc.path ? 'row active' : 'row'">
          <div class="col-12">
            <div class="name">{{ acc.name }}</div>
            <div class="address">
              <wallet-address [value]="acc.address" [copyButton]="true"></wallet-address>
            </div>
            <div class="last-tx">
              <span>{{ 'Last Transaction' | translate }}:&nbsp;</span>
              <span *ngIf="acc.lastTx">{{ acc.lastTx | dateAgo }}</span>
              <span *ngIf="!acc.lastTx">{{ 'None' | translate }}</span>
            </div>
          </div>
          <div class="col-12 text-right">
            <div class="balance">{{ acc.balance / 1e8 | number: '0.0-8' }} <small>ZBC</small></div>
            <div class="balance-in-currency">
              {{ (acc.balance / 1e8) * currencyRate.value | number: '0.0-2' }}
              <small>{{ currencyRate.name }}</small>
            </div>
          </div>
        </div>
      </mat-card>
    </div>

    <div class="no-content" *ngIf="accounts.length == 0">
      <i matPrefix class="far fa-address-card"></i>
      <span class="message">No Accounts on the list</span>
    </div>
  </div>
</ng-template>
